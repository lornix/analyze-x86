/*      analyze-x86
 *
 *      Copyright 2010 Meya Argenta <fierevere@ya.ru>
 *      Copyright 2012 Alexey Shvetsov <alexxy@gentoo.org>
 *
 *      This program is free software; you can redistribute it and/or modify
 *      it under the terms of the GNU General Public License as published by
 *      the Free Software Foundation; either version 2 of the License, or
 *      (at your option) any later version.
 *
 *      This program is distributed in the hope that it will be useful,
 *      but WITHOUT ANY WARRANTY; without even the implied warranty of
 *      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *      GNU General Public License for more details.
 *
 *      You should have received a copy of the GNU General Public License
 *      along with this program; if not, write to the Free Software
 *      Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
 *      MA 02110-1301, USA.
 */

#define NUMCALLS 3

long calls = 0;

static char setcalls [NUMCALLS] [6] = {
	"call",
	"callq",
        "lcall",
};

#define NUMJMPS 22

long jmps = 0;

static char setjmps [NUMJMPS] [6] = {
	"jmp",
        "jne",
        "jmpq",
        "je",
        "jbe",
	"je,pn",
	"jcxz",
	"jno",
	"jnp",
	"jo",
	"jecxz",
	"jp",
	"jns",
	"jae",
	"jl",
	"jb",
	"jge",
	"js",
	"ja",
	"jg",
	"jle",
        "ljmp",
};

#define NUMMOVS 2

long movs = 0;

static char setmovs [NUMMOVS] [5] = {
	"mov",
        "movb",
};

#define NUMNOPS 3

long nops = 0;

static char setnops [NUMNOPS] [5] = {
	"nop",
        "nopw",
        "nopl",
};

#define NUMRETS 2

long rets = 0;

static char setrets [NUMRETS] [5] = {
        "ret",
        "retq",
};

#define NUMSTACK 10

long stack = 0;

static char setstack [NUMSTACK] [6] = {
	"push",
        "pusha",
        "pushf",
        "pushl",
        "pushq",
	"pop",
        "popa",
        "popf",
        "popl",
        "popq",
};

#define NUMOTHER 2

long other = 0;

static char setother [NUMOTHER] [11] = {
	"movabs",
	"int3",
};

static char ignored [500] [11] __attribute__((used)) = {
        "(bad)",
        ".byte",
	"aaa",
	"aad",
	"aam",
	"aas",
	"adc",
	"adcl",
	"add",
	"addb",
	"addl",
	"addq",
	"addr16",
	"addw",
	"and",
	"andb",
	"andl",
	"andq",
	"andw",
	"arpl",
	"bound",
	"bsr",
	"bt",
	"bts",
	"cbtw",
	"clc",
	"cld",
	"cli",
	"cltd",
	"cltq",
	"cmc",
	"cmp",
	"cmpb",
	"cmpl",
	"cmpq",
	"cmpsb",
	"cmpsl",
	"cmpsw",
	"cmpw",
	"cqto",
	"cs",
	"cvtsi2sdl",
	"cvtsi2sdq",
	"cvtsi2ssl",
	"cvtsi2ssq",
	"cwtl",
	"daa",
	"das",
	"data16",
	"dec",
	"decb",
	"decl",
	"decw",
	"div",
	"divb",
	"divl",
	"ds",
	"enter",
	"f2xm1",
	"fabs",
	"fadd",
	"faddl",
	"faddp",
	"fadds",
	"fchs",
	"fcomp",
	"fdiv",
	"fdivl",
	"fdivp",
	"fdivr",
	"fdivrl",
	"fdivrp",
	"fdivrs",
	"fdivs",
	"fiadd",
	"fild",
	"fildl",
	"fildll",
	"fimull",
	"finit",
	"fistl",
	"fistp",
	"fistpl",
	"fistpll",
	"fisubl",
	"fld",
	"fld1",
	"fldcw",
	"fldl",
	"fldl2t",
	"fldlg2",
	"flds",
	"fldt",
	"fldz",
	"fmul",
	"fmull",
	"fmulp",
	"fmuls",
	"fnstcw",
	"fnstsw",
	"fprem",
	"frndint",
	"fs",
	"fscale",
	"fsqrt",
	"fstcw",
	"fstl",
	"fstp",
	"fstpl",
	"fstps",
	"fsts",
	"fstsw",
	"fsub",
	"fsubl",
	"fsubp",
	"fsubr",
	"fsubrl",
	"fsubrp",
	"fsubrs",
	"fsubs",
	"fucom",
	"fucomp",
	"fucompp",
	"fwait",
	"fxam",
	"fxch",
	"fyl2x",
	"gs",
	"hlt",
	"icebp",
	"idiv",
	"idivl",
	"imul",
	"imull",
	"in",
	"inc",
	"incb",
	"incl",
	"incw",
	"insb",
	"insl",
	"int",
	"into",
	"iret",
	"lahf",
	"lea",
	"leave",
	"leaveq",
	"les",
	"lock",
	"lods",
	"loop",
	"loope",
	"loopne",
	"lret",
	"movl",
	"movsb",
	"movsbl",
	"movsbq",
	"movsbw",
	"movsl",
	"movslq",
	"movsw",
	"movswl",
	"movswq",
	"movw",
	"movzbl",
	"movzwl",
	"mul",
	"mulb",
	"mull",
	"mulw",
	"neg",
	"negb",
	"negl",
	"negw",
	"not",
	"notb",
	"notl",
	"notw",
	"or",
	"orb",
	"orl",
	"orw",
	"out",
	"outsb",
	"outsl",
	"outsw",
	"punpcklqdq",
	"rcl",
	"rcrb",
	"rcrl",
	"rep",
	"repnz",
	"repz",
	"rol",
	"rolb",
	"roll",
	"rolw",
	"ror",
	"rorb",
	"rorl",
	"sahf",
	"sar",
	"sarb",
	"sarl",
	"sbb",
	"sbbb",
	"sbbl",
	"scas",
	"seta",
	"setae",
	"setb",
	"setbe",
	"sete",
	"setg",
	"setge",
	"setl",
	"setle",
	"setne",
	"setnp",
	"setp",
	"shl",
	"shlb",
	"shld",
	"shll",
	"shlw",
	"shr",
	"shrb",
	"shrd",
	"shrl",
	"shrw",
	"sqrtsd",
	"ss",
	"stc",
	"std",
	"sti",
	"stos",
	"sub",
	"subb",
	"subl",
	"subpd",
	"subq",
	"subsd",
	"subw",
	"syscall",
	"test",
	"testb",
	"testl",
	"testw",
	"ucomisd",
	"unpcklpd",
	"xchg",
	"xlat",
	"xor",
	"xorb",
	"xorl",
	"xorpd",
	"xorw",
};
